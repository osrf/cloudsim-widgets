<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../elements/elements.html">

<dom-module id="cs-machinekillbutton">
  <style>
      .miniButton {
        font-size: 0.8em;
        width: 7em;
      }
      .miniButton iron-icon {
        width: 1.5em;
        margin-right: 0.2em;
      }
      .killButton > iron-icon {
        --iron-icon-fill-color: #f00;
      }
  </style>
  <template>

    <gz-resources
      id="resources"
      url="[[portalurl]]"
      token="[[token]]"
      resourcename="simulator"
      data="[[machinedata]]"
      on-deleted="_onKilled"
    ></gz-resources>

    <paper-button raised class="killButton miniButton" on-tap="tapKill">
      <iron-icon icon="icons:close"></iron-icon>
      Kill
    </paper-button>

  </template>

  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'cs-machinekillbutton',
      attached: function() {
        console.log('cs-machinekillbutton widget attached!')
      },
      tapKill(e) {
        this.$.resources.deleteid = this.machine_id;
        this.$.resources.delete();
        this.fire('notification',
            {msg: "Request to kill machine has been sent.", type: "msg"})
      },
      _onKilled: function(e) {
        this.fire('notification',
            {msg: "Machine has been killed.", type: "msg"})
      },
      properties: {
        portalurl: {
          type: String,
          value: 'https://localhost:4000',
          notify: true
        },
        token: {
          type: String,
          value: 'placeholder',
          notify: true
        },
        machine_id: {
          type: String,
          value: 'placeholder',
          notify: true
        },
      },
    });
  })();
  </script>
</dom-module>
